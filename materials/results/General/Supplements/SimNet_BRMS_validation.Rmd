---
title: "BRMS models' validation"
output: 
    html_document:
        toc: true
        toc_float: true
        number_section: true
        code_folding: hide
        highlight: zenburn
knit: (function(inputFile, encoding) 
        {
          rmarkdown::render(inputFile, encoding = encoding, output_dir = "markdowns") 
        }
      )
---

<style>
pre {
overflow-x: auto;
}
pre code {
word-wrap: normal;
white-space: pre;
}
</style>

```{r setup, include=FALSE}

options(width = 1000)

knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      fig.height = 4,
                      fig.width = 8,
                      size = "small") 

library(tidyverse)
library(knitr)
library(rstan)
library(brms)
library(tidybayes)
library(modelr)
library(sjstats)
library(sjPlot)

setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
setwd("../../../../data/brms_models")

models <- readRDS(file = "biomass_brms_models.rds") %>% 
    filter(measure == "Shannon")

```

This document describes the statistical models' validation, using **Shannon diversity** as the focal biodiversity metric and **total biomass** as the focal ecosystem function.

Important terms:

* `Stage`: metacommunity represents *with* seed rain, isolation represents *without* seed rain
* `Ninitial`: Planted species richness

****************************************************************************************************
# C2018

Thomas Clark, A., C. Lehman, and D. Tilman. 2018. Identifying mechanisms that structure ecological communities by snapping model parameters to empirically observed trade-offs. Ecology Letters 21:494–505.

```{r C2018-setup, include=FALSE}

C2018 <- models %>% filter(Model == "adam")

```

## Across-treatment effect

A summary table of the BRMS model results:
```{r C2018-across-treatment-effect}

C2018$mainEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r C2018-across-treatment-effect-R2}

rstantools::bayes_R2(C2018$mainEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

We next use posterior predictive checks (PPC) to judge the fit of the model. These compare the real data to the posterior distribution, conditioned on the observed data.

#### Density plot
The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r C2018-across-treatment-PPC-PDF}

brms::pp_check(C2018$mainEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw() 

```

#### Scatter plot
Average prediction (`y_rep`) for each real data point (`y`). A line indicates a 1:1 correspondence for reference.
```{r C2018-across-treatment-scatter-avg}

brms::pp_check(C2018$mainEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Stage") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval
Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r C2018-across-treatment-HDI}

sjPlot::plot_model(C2018$mainEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
## Within-treatment effect

A summary table of the BRMS model results:
```{r C2018-within-treatment-effect-display}

C2018$treatmentEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r C2018-within-treatment-effect-R2}

rstantools::bayes_R2(C2018$treatmentEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

#### Density plot

The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r C2018-within-treatment-effect-PPC-PDF}

brms::pp_check(C2018$treatmentEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw()

```

#### Scatter plot

Average prediction (`y_rep`) for each real data point (`y`), grouping the comparison of `y` to `y_rep` by `Ninitial`. A line indicates a 1:1 correspondence for reference.
```{r C2018-within-treatment-effect-PPC-scatter-avg}

brms::pp_check(C2018$treatmentEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Ninitial") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval

Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r C2018-within-treatment-effect-HDI}

sjPlot::plot_model(C2018$treatmentEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
# T2013

Turnbull, L. A., J. M. Levine, M. Loreau, and A. Hector. 2013. Coexistence, niches and biodiversity effects on ecosystem functioning. Ecology Letters 16:116–127.

```{r T2013-setup, include=FALSE}

T2013 <- models %>% filter(Model == "lindsay")

```

## Across-treatment effect

A summary table of the BRMS model results:
```{r T2013-across-treatment-effect}

T2013$mainEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r T2013-across-treatment-effect-R2}

rstantools::bayes_R2(T2013$mainEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

We next use posterior predictive checks (PPC) to judge the fit of the model. These compare the real data to the posterior distribution, conditioned on the observed data.

#### Density plot
The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r T2013-across-treatment-PPC-PDF}

brms::pp_check(T2013$mainEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw() 

```

#### Scatter plot
Average prediction (`y_rep`) for each real data point (`y`). A line indicates a 1:1 correspondence for reference.
```{r T2013-across-treatment-scatter-avg}

brms::pp_check(T2013$mainEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Stage") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval
Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r T2013-across-treatment-HDI}

sjPlot::plot_model(T2013$mainEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
## Within-treatment effect

A summary table of the BRMS model results:
```{r T2013-within-treatment-effect-display}

T2013$treatmentEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r T2013-within-treatment-effect-R2}

rstantools::bayes_R2(T2013$treatmentEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

#### Density plot

The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r T2013-within-treatment-effect-PPC-PDF}

brms::pp_check(T2013$treatmentEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw()

```

#### Scatter plot

Average prediction (`y_rep`) for each real data point (`y`), grouping the comparison of `y` to `y_rep` by `Ninitial`. A line indicates a 1:1 correspondence for reference.
```{r T2013-within-treatment-effect-PPC-scatter-avg}

brms::pp_check(T2013$treatmentEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Ninitial") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval

Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r T2013-within-treatment-effect-HDI}

sjPlot::plot_model(T2013$treatmentEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
# M2009

May, F., V. Grimm, and F. Jeltsch. 2009. Reversed effects of grazing on plant diversity: The role of below-ground competition and size symmetry. Oikos 118:1830–1843.

```{r M2009-setup, include=FALSE}

M2009 <- models %>% filter(Model == "IBC_grass.NDD")

```

## Across-treatment effect

A summary table of the BRMS model results:
```{r M2009-across-treatment-effect}

M2009$mainEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r M2009-across-treatment-effect-R2}

rstantools::bayes_R2(M2009$mainEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

We next use posterior predictive checks (PPC) to judge the fit of the model. These compare the real data to the posterior distribution, conditioned on the observed data.

#### Density plot
The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r M2009-across-treatment-PPC-PDF}

brms::pp_check(M2009$mainEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw() 

```

#### Scatter plot
Average prediction (`y_rep`) for each real data point (`y`). A line indicates a 1:1 correspondence for reference.
```{r M2009-across-treatment-scatter-avg}

brms::pp_check(M2009$mainEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Stage") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval
Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r M2009-across-treatment-HDI}

sjPlot::plot_model(M2009$mainEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
## Within-treatment effect

A summary table of the BRMS model results:
```{r M2009-within-treatment-effect-display}

M2009$treatmentEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r M2009-within-treatment-effect-R2}

rstantools::bayes_R2(M2009$treatmentEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

#### Density plot

The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r M2009-within-treatment-effect-PPC-PDF}

brms::pp_check(M2009$treatmentEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw()

```

#### Scatter plot

Average prediction (`y_rep`) for each real data point (`y`), grouping the comparison of `y` to `y_rep` by `Ninitial`. A line indicates a 1:1 correspondence for reference.
```{r M2009-within-treatment-effect-PPC-scatter-avg}

brms::pp_check(M2009$treatmentEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Ninitial") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval

Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r M2009-within-treatment-effect-HDI}

sjPlot::plot_model(M2009$treatmentEffect[[1]],
                   title = "89% Highest-density intervals")

```


****************************************************************************************************
# R2020

Rüger, N., R. Condit, D. H. Dent, S. J. DeWalt, S. P. Hubbell, J. W. Lichstein, O. R. Lopez, C. Wirth, and C. E. Farrior. 2020. Demographic trade-offs predict tropical forest dynamics. Science 368:165–168.

```{r R2020-setup, include=FALSE}

R2020 <- models %>% filter(Model == "PPA")

```

## Across-treatment effect

A summary table of the BRMS model results:
```{r R2020-across-treatment-effect}

R2020$mainEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r R2020-across-treatment-effect-R2}

rstantools::bayes_R2(R2020$mainEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

We next use posterior predictive checks (PPC) to judge the fit of the model. These compare the real data to the posterior distribution, conditioned on the observed data.

#### Density plot
The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r R2020-across-treatment-PPC-PDF}

brms::pp_check(R2020$mainEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw() 

```

#### Scatter plot
Average prediction (`y_rep`) for each real data point (`y`). A line indicates a 1:1 correspondence for reference.
```{r R2020-across-treatment-scatter-avg}

brms::pp_check(R2020$mainEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Stage") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval
Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r R2020-across-treatment-HDI}

sjPlot::plot_model(R2020$mainEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
## Within-treatment effect

A summary table of the BRMS model results:
```{r R2020-within-treatment-effect-display}

R2020$treatmentEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r R2020-within-treatment-effect-R2}

rstantools::bayes_R2(R2020$treatmentEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

#### Density plot

The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r R2020-within-treatment-effect-PPC-PDF}

brms::pp_check(R2020$treatmentEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw()

```

#### Scatter plot

Average prediction (`y_rep`) for each real data point (`y`), grouping the comparison of `y` to `y_rep` by `Ninitial`. A line indicates a 1:1 correspondence for reference.
```{r R2020-within-treatment-effect-PPC-scatter-avg}

brms::pp_check(R2020$treatmentEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Ninitial") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval

Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r R2020-within-treatment-effect-HDI}

sjPlot::plot_model(R2020$treatmentEffect[[1]],
                   title = "89% Highest-density intervals")

```


****************************************************************************************************
# M2017

Maréchaux, I., and J. Chave. 2017. An individual-based forest model to jointly simulate carbon and tree diversity in Amazonia: description and applications. Ecological Monographs.

```{r M2017-setup, include=FALSE}

M2017 <- models %>% filter(Model == "TROLL")

```

## Across-treatment effect

A summary table of the BRMS model results:
```{r M2017-across-treatment-effect}

M2017$mainEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r M2017-across-treatment-effect-R2}

rstantools::bayes_R2(M2017$mainEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

We next use posterior predictive checks (PPC) to judge the fit of the model. These compare the real data to the posterior distribution, conditioned on the observed data.

#### Density plot
The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r M2017-across-treatment-PPC-PDF}

brms::pp_check(M2017$mainEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw() 

```

#### Scatter plot
Average prediction (`y_rep`) for each real data point (`y`). A line indicates a 1:1 correspondence for reference.
```{r M2017-across-treatment-scatter-avg}

brms::pp_check(M2017$mainEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Stage") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval
Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r M2017-across-treatment-HDI}

sjPlot::plot_model(M2017$mainEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
## Within-treatment effect

A summary table of the BRMS model results:
```{r M2017-within-treatment-effect-display}

M2017$treatmentEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r M2017-within-treatment-effect-R2}

rstantools::bayes_R2(M2017$treatmentEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

#### Density plot

The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r M2017-within-treatment-effect-PPC-PDF}

brms::pp_check(M2017$treatmentEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw()

```

#### Scatter plot

Average prediction (`y_rep`) for each real data point (`y`), grouping the comparison of `y` to `y_rep` by `Ninitial`. A line indicates a 1:1 correspondence for reference.
```{r M2017-within-treatment-effect-PPC-scatter-avg}

brms::pp_check(M2017$treatmentEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Ninitial") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval

Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r M2017-within-treatment-effect-HDI}

sjPlot::plot_model(M2017$treatmentEffect[[1]],
                   title = "89% Highest-density intervals")

```


****************************************************************************************************
# R2006

Reineking, B., M. Veste, C. Wissel, and A. Huth. 2006. Environmental variability and allocation trade-offs maintain species diversity in a process-based model of succulent plant communities. Ecological Modelling.

```{r R2006-setup, include=FALSE}

R2006 <- models %>% filter(Model == "bjoern")

```

## Across-treatment effect

A summary table of the BRMS model results:
```{r R2006-across-treatment-effect}

R2006$mainEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r R2006-across-treatment-effect-R2}

rstantools::bayes_R2(R2006$mainEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

We next use posterior predictive checks (PPC) to judge the fit of the model. These compare the real data to the posterior distribution, conditioned on the observed data.

#### Density plot
The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r R2006-across-treatment-PPC-PDF}

brms::pp_check(R2006$mainEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw() 

```

#### Scatter plot
Average prediction (`y_rep`) for each real data point (`y`). A line indicates a 1:1 correspondence for reference.
```{r R2006-across-treatment-scatter-avg}

brms::pp_check(R2006$mainEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Stage") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval
Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r R2006-across-treatment-HDI}

sjPlot::plot_model(R2006$mainEffect[[1]],
                   title = "89% Highest-density intervals")

```

****************************************************************************************************
## Within-treatment effect

A summary table of the BRMS model results:
```{r R2006-within-treatment-effect-display}

R2006$treatmentEffect[[1]]

```
> Note the `Rhat` summary column: variation from 1.0 indicates the the model did not converge.

The Bayesian R-squared:
```{r R2006-within-treatment-effect-R2}

rstantools::bayes_R2(R2006$treatmentEffect[[1]])

```

****************************************************************************************************
### Posterior predictive checks

#### Density plot

The density of both the real data (`y`, black line), and from fitted draws of the models (`y_rep`, blue lines).
```{r R2006-within-treatment-effect-PPC-PDF}

brms::pp_check(R2006$treatmentEffect[[1]]) +
    labs(x = "Total biomass") +
    theme_bw()

```

#### Scatter plot

Average prediction (`y_rep`) for each real data point (`y`), grouping the comparison of `y` to `y_rep` by `Ninitial`. A line indicates a 1:1 correspondence for reference.
```{r R2006-within-treatment-effect-PPC-scatter-avg}

brms::pp_check(R2006$treatmentEffect[[1]],
               type = 'scatter_avg_grouped',
               group = "Ninitial") +
    geom_abline(intercept = 0,
                slope = 1) +
    labs(title = "Realized total biomass to average predicted total biomass") +
    theme_bw()

```

#### Highest-density interval

Highest-density interval (HDI) for each effect within the model. This characterizes the uncertainty of our posterior distributions. Highest-density intervals can be thought of as credibility intervals (see [here](https://mathematica.stackexchange.com/questions/173282/computing-credible-region-highest-posterior-density-from-empirical-distributio)). We use the 89% HDI as recommended by Kruschke (2014), see [here](https://easystats.github.io/bayestestR/reference/hdi.html) for more information.
```{r R2006-within-treatment-effect-HDI}

sjPlot::plot_model(R2006$treatmentEffect[[1]],
                   title = "89% Highest-density intervals")

```
